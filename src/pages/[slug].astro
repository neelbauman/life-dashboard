---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro'; // 共通レイアウトをインポート

// 1. ビルド時に 'items' コレクションの全アイテムのページを生成する設定
export async function getStaticPaths() {
  const items = await getCollection('items');
  return items.map(item => ({
    params: { slug: item.slug },
    props: { item },
  }));
}

// 2. 渡された item の情報を取得
const { item } = Astro.props;
// 3. Markdown 本文を <Content /> コンポーネントとして取得
const { Content } = await item.render();
---
<Layout>
  <h2>{item.data.name} (詳細)</h2>
  <ul>
    <li><strong>価格:</strong> {item.data.price.toLocaleString()} 円</li>
    <li><strong>ステータス:</strong> {item.data.status}</li>
    <li><strong>カテゴリ:</strong> {item.data.category}</li>
    {item.data.priority && <li><strong>優先度:</strong> {item.data.priority}</li>}
    {item.data.purchase_date && <li><strong>購入日:</strong> {item.data.purchase_date.toLocaleDateString('ja-JP')}</li>}
  </ul>
  
  <hr />

  <article>
    <Content />
  </article>

  <hr />
  <a href={import.meta.env.BASE_URL}>ダッシュボードに戻る</a>
</Layout>
